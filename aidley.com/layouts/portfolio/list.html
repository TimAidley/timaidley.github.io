{{ define "main" }}
{{ $data := index .Site.Data .Site.Language.Lang "portfolio" }}
{{ if not $data }}{{ $data = .Site.Data.portfolio }}{{ end }}
{{ range $index, $element := $data.portfolioitems }}
<div class="post {{ with .Site.Params.doNotLoadAnimations }}
        .
      {{ else }}
        animated fadeInDown
      {{ end }}">
    {{ $anchorTitle := delimit (split .title " ") "" }}

    <h2 class="portfolio__title" id="{{ $anchorTitle | lower }}">{{ title .title }}</h2>
    {{ if .description }}
    <h4>{{ .description }}</h4>
    {{ end }}

    {{ range $i, $p := .portfolioitem }}
    <div class="portfolio-item">
        <div class="portfolio-item__main">
            {{ if .image }}
            <div class="portfolio-item__image">
                {{ if .link }}
                <a href="{{ .link | safeURL }}" target="_blank" rel="noopener">
                    <img src="{{ .image | relURL }}" alt="{{ .name | markdownify }}" />
                </a>
                {{ else }}
                <img src="{{ .image | relURL }}" alt="{{ .name | markdownify }}" />
                {{ end }}
            </div>
            {{ end }}

            <div class="portfolio-item__content">
                <h2>{{ .name | markdownify }}</h2>

                <ul class="portfolio__meta">
                    {{ if .company }}
                    <li class="portfolio__meta-item">
                        <em class="fas fa-building"></em>
                        <span>{{ .company }}</span>
                    </li>
                    {{ end }}
                    {{ if .status }}
                    <li class="portfolio__meta-item">
                        <em class="fas fa-flag-checkered"></em>
                        <span>{{ .status }}</span>
                    </li>
                    {{ end }}
                    {{ if .start }}
                    <li class="portfolio__meta-item">
                        <em class="fas fa-calendar"></em>
                        <span>{{ .start }}</span>
                    </li>
                    {{ end }}
                    {{ if .end }}
                    <li class="portfolio__meta-item">
                        <em class="fas fa-calendar"></em>
                        <span>{{ .end }}</span>
                    </li>
                    {{ end }}
                </ul>

                <p>{{ .description | markdownify }}</p>

                {{ if .link }}
                <div class="portfolio__button-wrapper">
                    <a class="portfolio__button" href="{{ .link | safeURL }}" target="_blank" rel="noopener">
                        {{- if .linktext -}}
                        {{ .linktext | markdownify }}
                        {{- else -}}
                        Visit Site
                        {{- end -}}
                    </a>
                </div>
                {{ end }}

                <div class="separator">
                    {{ range .tags }}
                    <p class="tag">{{ . }}</p>
                    {{ end }}
                </div>
            </div>
        </div>

        {{ if .screenshots }}
        <div class="portfolio-item__screenshots">
            <h3>Screenshots</h3>
            <div class="portfolio-item__screenshots-grid">
                {{ range .screenshots }}
                <div class="portfolio-item__screenshot">
                    <img src="{{ . | relURL }}" alt="Screenshot" />
                </div>
                {{ end }}
            </div>
        </div>
        {{ end }}
    </div>
    {{ end }}
</div>
{{ end }}

{{ end }}